"use strict";(self.webpackChunkmmsp_land_hl=self.webpackChunkmmsp_land_hl||[]).push([[8202],{78202:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var a=i(27366),r=i(40281),s=i(32718),n=(i(93169),i(84936),i(10064),i(69912)),d=i(88109),l=i(42537),o=i(66978),u=i(76672),p=i(49861);const c=Symbol(),h=e=>{let t=class extends e{constructor(){super(...arguments),this.layerViews=new r.Z,this._debouncedUpdate=(0,o.Ds)((async()=>{const{layer:e,parent:t}=this,i=null===t||void 0===t?void 0:t.footprintLayerView;let a=[];const r=this._createQuery();if(r&&i){const{features:t}=await i.queryFeatures(r);this.suspended||(a=t.map((t=>e.acquireLayer(t))))}this.removeHandles(c),this.addHandles(a,c)}))}get creatingLayerViews(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.layerViewManager.isCreatingLayerViewsForLayer(this.layer))&&void 0!==e&&e}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some((e=>e.updating))}enableLayerUpdates(){return(0,l.AL)([this._updatingHandles.addWhen((()=>{var e;return!1===(null===(e=this.parent)||void 0===e||null===(e=e.footprintLayerView)||void 0===e?void 0:e.dataUpdating)}),(()=>this.updateLayers())),this._updatingHandles.add((()=>{var e,t,i;return[this.layer.maximumVisibleSublayers,null===(e=this.layer.parent)||void 0===e?void 0:e.orderBy,null===(t=this.parent)||void 0===t||null===(t=t.footprintLayerView)||void 0===t?void 0:t.filter,null===(i=this.parent)||void 0===i||null===(i=i.footprintLayerView)||void 0===i?void 0:i.timeExtent,this.suspended]}),(()=>this.updateLayers())),(0,l.kB)((()=>this.removeHandles(c)))])}updateLayers(){this.suspended?this.removeHandles(c):this._updatingHandles.addPromise((0,o.R8)(this._debouncedUpdate()).catch((e=>{s.Z.getLogger(this).error(e)})))}_createQuery(){var e,t;const i=null===(e=this.parent)||void 0===e?void 0:e.footprintLayerView,a=null===(t=this.layer)||void 0===t?void 0:t.parent;if(!i||!a||a.destroyed)return null;const{layer:{maximumVisibleSublayers:r},view:{scale:s}}=this;if(!r)return null;const{itemTypeField:n,itemSourceField:d,itemNameField:l,minScaleField:o,maxScaleField:p,objectIdField:c,orderBy:h}=a,y=(0,u._)("".concat(o," IS NULL OR ").concat(s," <= ").concat(o," OR ").concat(o," = 0"),"".concat(p," IS NULL OR ").concat(s," >= ").concat(p)),v=null===h||void 0===h?void 0:h.find((e=>e.field&&!e.valueExpression)),m=i.createQuery();if(m.returnGeometry=!1,m.num=r,m.outFields=[c,d,l],m.where=(0,u._)(m.where,y),null!=this.unsupportedItemTypes){const e="".concat(n," NOT IN (").concat(this.unsupportedItemTypes.map((e=>"'".concat(e,"'"))),")");m.where=(0,u._)(m.where,e)}return null!==v&&void 0!==v&&v.field&&(m.orderByFields=["".concat(v.field," ").concat("descending"===v.order?"DESC":"ASC")],m.outFields.push(v.field)),m}};return(0,a._)([(0,p.Cb)({readOnly:!0})],t.prototype,"creatingLayerViews",null),(0,a._)([(0,p.Cb)()],t.prototype,"layer",void 0),(0,a._)([(0,p.Cb)()],t.prototype,"layerViews",void 0),(0,a._)([(0,p.Cb)({readOnly:!0})],t.prototype,"unsupportedItemTypes",void 0),(0,a._)([(0,p.Cb)()],t.prototype,"parent",void 0),(0,a._)([(0,p.Cb)({readOnly:!0})],t.prototype,"isUpdating",null),t=(0,a._)([(0,n.j)("esri.views.layers.CatalogDynamicGroupLayerView")],t),t};var y=i(67581);let v=class extends(h((0,d.y)(y.Z))){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new r.Z}attach(){this.addAttachHandles([this.layerViews.on("after-changes",(()=>this._updateStageChildren())),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(e){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,t)=>this.container.addChildAt(e.container,t)))}};v=(0,a._)([(0,n.j)("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],v);const m=v}}]);
//# sourceMappingURL=8202.e74e49b0.chunk.js.map